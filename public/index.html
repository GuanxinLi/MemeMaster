<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Welcome to MemeMaster</title>
    <script src="https://www.gstatic.com/firebasejs/5.6.0/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/5.6.0/firebase-auth.js"></script>
    <script src="https://www.gstatic.com/firebasejs/5.6.0/firebase-database.js"></script>
    <script src="https://cdn.firebase.com/libs/firebaseui/3.1.1/firebaseui.js"></script>
    <link type="text/css" rel="stylesheet" href="https://cdn.firebase.com/libs/firebaseui/3.1.1/firebaseui.css" />

    <script type="module" src="js/component/memeCreater.js"></script>
    <script type="module" src="js/firebase/credentials.js"></script>
    <script type ="module" src="js/firebase/authentication.js"></script>
    <script type="text/javascript" src="js/component/login.js"></script>


    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css">
    <script src="https://code.jquery.com/jquery-3.3.1.min.js"></script>
    <script src="https://ucarecdn.com/libs/widget/3.x/uploadcare.min.js"></script>
    <script src="https://ucarecdn.com/libs/widget-tab-effects/1.x/uploadcare.tab-effects.min.js"></script>
    
  </head>
  <body>
    <h1>Welcome to meme master!</h1>
    <button id="signInBtn">Click me</button>
    <meme-canvas id = "memeCreator" imgSrc="./google2.0.0.jpg" top="TOP TEXT" bottom="BOTTOM TEXT"></meme-canvas>
    <script >
      let d = null;
      window.onload = () => {
        d = render();
      }
      var modal = document.getElementById('loginForm');
      var login = document.getElementById('signInBtn');
      var meme = document.getElementById('memeCreator');
      login.onclick = ()=>{
        d.style.display = "block";
      }
    </script>

    <h1> HERE!!!!!!!!</h1>
<div class="container mt-4">
    <div class="float-right mb-4 mt-2">
      <input type="hidden" role="uploadcare-uploader" id="uploadedImage" />
    </div>
  
    <h2 class="mb-4">Simple Image Hosting</h2>
  
    <div class="row" id="imagesContainer"></div>
  </div>
  <script>
    window.UPLOADCARE_PUBLIC_KEY = 'demopublickey'
//uploadcare.registerTab('preview', uploadcareTabEffects)

const widget = uploadcare.Widget('[role=uploadcare-uploader]')
let images = null;

widget.onUploadComplete(function(info) {
  saveImage(info.cdnUrl).then(() => {
    meme.updateBackGround(info.cdnUrl);
  })
})

// fetchImages().then(uploadedImages => {
//   images = uploadedImages
//   const imageHtml = images.reduce((html, url) => {
//     const fullUrl = `${url}/-/preview/-/scale_crop/200x200/`

//     return (
//       html +
//       '<div class="col" >' +
//       '<a href="#" class="d-block mb-4 h-100">' +
//       `<img class="img-fluid img-thumbnail" src="${fullUrl}">` +
//       '</a>' +
//       '</div>'
//     )
//   }, '')

//   $(imageHtml).appendTo('#imagesContainer')
// })

function fetchImages() {
  return new Promise(resolve => {
    const images = JSON.parse(localStorage.getItem('images') || '[]')

    setTimeout(() => resolve(images), 500)
  })
}

function saveImage(url) {
  return new Promise(resolve => {
    images = url;
    localStorage.setItem('images', JSON.stringify(images))
    setTimeout(() => resolve(), 500)
  })
}

function refreshPage() {
  window.location.href = window.location.href
}
  </script>
  </body>
</html>
